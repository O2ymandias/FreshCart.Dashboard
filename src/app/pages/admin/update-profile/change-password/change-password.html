<p-card>
  <form  [formGroup]="changePasswordForm" (ngSubmit)="submit()" class="flex flex-col gap-4">

    @let currentPassword = changePasswordForm.controls.currentPassword;
    <div class="flex flex-col gap-2 ">
      <label
        class="block"
        for="currentPassword"
        >Current Password</label
      >
      <p-password
        formControlName="currentPassword"
        inputId="currentPassword"
        [toggleMask]="true"
        [feedback]="false"
        fluid
      />
      @if ((currentPassword.dirty || currentPassword.touched) && currentPassword.hasError("required")) {
        <p-message severity="error" variant="simple" size="small">
          Current Password is required
        </p-message>
      }
    </div>

    @let newPassword = changePasswordForm.controls.newPassword;
    <div class="flex flex-col gap-2 ">
      <label class="block" for="newPassword"
        >New Password</label
      >
      <p-password
        formControlName="newPassword"
        inputId="newPassword"
        [toggleMask]="true"
        [feedback]="false"
        fluid
      />
      @if ((newPassword.dirty || newPassword.touched) && newPassword.hasError("required")) {
        <p-message severity="error" variant="simple" size="small">
          New Password is required
        </p-message>
      }
      @if ((newPassword.dirty || newPassword.touched) && newPassword.hasError("pattern")) {
      <p-message severity="error" variant="simple" size="small">
          <p class="font-medium">Password must contain:</p>
          <ul class="list-disc ps-6 text-sm">
            <li>At least 6 characters</li>
            <li>One lowercase letter (a–z)</li>
            <li>One uppercase letter (A–Z)</li>
            <li>One number (0–9)</li>
            <li>One special character (@$!%*?&)</li>
          </ul>
      </p-message>
      }
    </div>


    @let confirmNewPassword = changePasswordForm.controls.confirmNewPassword;
    <div class="flex flex-col gap-2 ">
      <label
        class="block"
        for="confirmNewPassword"
        >Confirm New Password</label
      >
      <p-password
        formControlName="confirmNewPassword"
        inputId="confirmNewPassword"
        [toggleMask]="true"
        [feedback]="false"
        fluid
      />
      @if (confirmNewPassword.dirty && confirmNewPassword.hasError("required")) {
        <p-message severity="error" variant="simple" size="small">
          Confirm New Password is required
        </p-message>
      }
    </div>

    @if (confirmNewPassword.dirty && newPassword.dirty && changePasswordForm.hasError("nomatch")) {
      <p-message severity="warn" variant="text" >
        "New Password" and "Confirm New Password" are not the same.
      </p-message>
    }

    <div class="flex items-center justify-end ">
      <p-button
        label="Submit"
        type="submit"
        [loading]="loading()"
        [disabled]="!changePasswordForm.valid"
      />
    </div>

  </form>
</p-card>
